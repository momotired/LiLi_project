# 设备模板模块 API

## 概述
管理不同类型设备的模板，包括手机、电脑、相机、耳机等设备的规格模板，用于规范设备录入时的必填项和可选项。

## 接口列表

### 1. 获取设备模板列表

**接口描述:** 获取所有设备模板

**请求方式:** `GET`

**请求路径:** `/device-templates`

**是否需要认证:** 是

**请求参数:**
- `category_id`: int, 分类ID, 可选
- `active`: bool, 是否只显示启用的模板, 可选, 默认true

**业务逻辑:**
1. 查询设备模板列表
2. 按分类筛选
3. 返回模板基本信息和字段定义

---

### 2. 获取设备模板详情

**接口描述:** 获取指定设备模板的详细信息

**请求方式:** `GET`

**请求路径:** `/device-templates/{template_id}`

**是否需要认证:** 是

**请求参数:**
- `template_id`: int, 模板ID, 路径参数, 必填

**业务逻辑:**
1. 获取模板基本信息
2. 获取模板字段定义
3. 返回完整的模板结构

---

### 3. 获取模板字段定义

**接口描述:** 获取指定模板的字段定义

**请求方式:** `GET`

**请求路径:** `/device-templates/{template_id}/fields`

**是否需要认证:** 是

**请求参数:**
- `template_id`: int, 模板ID, 路径参数, 必填

**业务逻辑:**
1. 获取模板所有字段定义
2. 包含字段类型、是否必填、验证规则等
3. 返回字段配置信息

---

### 4. 创建设备模板（管理员）

**接口描述:** 创建新的设备模板

**请求方式:** `POST`

**请求路径:** `/device-templates`

**是否需要认证:** 是（需要管理员权限）

**请求参数:**
```json
{
  "name": "string, 模板名称, 必填",
  "category_id": "int, 分类ID, 必填",
  "description": "string, 模板描述, 可选",
  "icon": "string, 图标URL, 可选",
  "fields": "array, 字段定义数组, 必填",
  "active": "bool, 是否启用, 可选, 默认true"
}
```

**字段定义结构:**
```json
{
  "field_name": "string, 字段名称, 必填",
  "field_label": "string, 字段显示名称, 必填",
  "field_type": "string, 字段类型(text/number/select/date/textarea), 必填",
  "required": "bool, 是否必填, 必填",
  "default_value": "string, 默认值, 可选",
  "validation_rules": "string, 验证规则, 可选",
  "options": "array, 选项列表(仅select类型), 可选",
  "placeholder": "string, 占位符, 可选",
  "help_text": "string, 帮助文本, 可选"
}
```

**业务逻辑:**
1. 验证管理员权限
2. 验证模板数据格式
3. 验证字段定义
4. 创建模板记录
5. 创建字段定义记录

---

### 5. 更新设备模板（管理员）

**接口描述:** 更新设备模板

**请求方式:** `PUT`

**请求路径:** `/device-templates/{template_id}`

**是否需要认证:** 是（需要管理员权限）

**请求参数:**
- `template_id`: int, 模板ID, 路径参数, 必填
- 其他参数同创建模板接口，均为可选

**业务逻辑:**
1. 验证管理员权限
2. 验证模板存在性
3. 更新模板信息
4. 更新字段定义
5. 记录修改历史

---

### 6. 删除设备模板（管理员）

**接口描述:** 删除设备模板

**请求方式:** `DELETE`

**请求路径:** `/device-templates/{template_id}`

**是否需要认证:** 是（需要管理员权限）

**请求参数:**
- `template_id`: int, 模板ID, 路径参数, 必填

**业务逻辑:**
1. 验证管理员权限
2. 检查模板是否被使用
3. 软删除模板（标记为已删除）
4. 删除相关字段定义

---

### 7. 获取热门设备模板

**接口描述:** 获取使用频率最高的设备模板

**请求方式:** `GET`

**请求路径:** `/device-templates/popular`

**是否需要认证:** 是

**请求参数:**
- `limit`: int, 返回数量, 可选, 默认10

**业务逻辑:**
1. 统计各模板使用次数
2. 按使用频率排序
3. 返回热门模板列表

---

### 8. 验证设备数据

**接口描述:** 根据模板验证设备数据

**请求方式:** `POST`

**请求路径:** `/device-templates/{template_id}/validate`

**是否需要认证:** 是

**请求参数:**
- `template_id`: int, 模板ID, 路径参数, 必填
- `device_data`: json, 设备数据, 必填

**业务逻辑:**
1. 获取模板字段定义
2. 验证必填字段
3. 验证数据格式
4. 验证数据有效性
5. 返回验证结果

---

### 9. 获取推荐模板

**接口描述:** 基于用户历史记录推荐设备模板

**请求方式:** `GET`

**请求路径:** `/device-templates/recommendations`

**是否需要认证:** 是

**请求参数:** 无

**业务逻辑:**
1. 分析用户历史添加的设备类型
2. 分析用户标签偏好
3. 推荐相关设备模板
4. 返回推荐列表

---

### 10. 获取模板统计信息

**接口描述:** 获取模板使用统计信息

**请求方式:** `GET`

**请求路径:** `/device-templates/{template_id}/statistics`

**是否需要认证:** 是

**请求参数:**
- `template_id`: int, 模板ID, 路径参数, 必填

**业务逻辑:**
1. 统计模板使用次数
2. 统计基于该模板创建的设备数量
3. 统计用户分布
4. 返回统计信息 